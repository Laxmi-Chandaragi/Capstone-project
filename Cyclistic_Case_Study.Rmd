---
title: "Cyclistic Bike-Share Case Study"
author: "Laxmi Chandaragi"
output: html_document
---

# **Cyclistic Bike-Share Case Study (R Language)**

## **1. Introduction**

Cyclistic is a bike-share company seeking to understand how casual riders and annual members use its services differently.  
The goal is to discover insights that help convert casual riders into annual members.


## **2. Business Task**

**Identify behavioral differences between casual riders and members** to support marketing strategies that increase annual memberships.


## **3. Data Sources**

- Divvy/Cyclistic bike-share data (public, anonymized)
- 12 months of CSV files containing ride-level information

Each dataset typically contains:

- `ride_id`
- `rideable_type`
- `started_at`
- `ended_at`
- `start_station_name`
- `end_station_name`
- `member_casual`

---

## **4. Data Preparation in R**


```{r}
library(tidyverse)
library(lubridate)
library(janitor)
library(skimr)
```

## Set dplyr::filter and dplyr::lag as the default choices
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")

#Step 1: Upload datasets(csv files)
```{r}
q1_2019 <- read.csv("C:\\Users\\Admin\\Downloads\\Case-Study-R\\Trips_2019_Q1.csv")
q1_2020 <- read.csv("C:\\Users\\Admin\\Downloads\\Case-Study-R\\Trips_2020_Q1.csv")
```

#Step 2: Wrangle data and Combine into a single file
```{r}
colnames(q1_2019)
colnames(q1_2020)
```

#Rename columns to them consistent
```{r}
(q1_2019 <-  rename(q1_2019
            ,ride_id = trip_id
            ,rideable_type= bikeid
            ,started_at = start_time
            ,ended_at = end_time
            ,start_station_name = from_station_name
            ,start_station_id = from_station_id
            ,end_station_name = to_station_name
            ,end_station_id = to_station_id
            ,member_casual = usertype
            ))
```


```{r}
str(q1_2019)
str(q1_2020)
```


##Convert ride_id and rideable_type to character so that they can stack correctly
```{r}
q1_2019 <- mutate(q1_2019, ride_id = as.character(ride_id),
                  rideable_type = as.character(rideable_type))
```


#Remove let, long, birthyear, and gender fields as this data was dropped beginning in 2020

```{r}
all_trips <- bind_rows(q1_2019, q1_2020)

all_trips <- all_trips %>% 
  select(-c(start_lat,start_lng,end_lat,end_lng,birthyear,gender, "tripduration"))
```

#Step 3: Clean up and add data to prepare for analysis
```{r}
colnames(all_trips)
nrow(all_trips)
dim(all_trips)
head(all_trips)
str(all_trips)
summary(all_trips)
```

#Begin by seeing how many obervations fall under each usertype
```{r}
table(all_trips$member_casual)

all_trips <- all_trips %>% 
  mutate(member_casual = recode(member_casual,
            "Subscriber" = "member", "Customer" = "casual"))
```


#check to make sure the proper number of observations were reassigned
```{r}
table(all_trips$member_casual)

all_trips$date <- as.Date(all_trips$started_at)
all_trips$month <- format(as.Date(all_trips$date), "%m")
all_trips$day <- format(as.Date(all_trips$date), "%d")
all_trips$year <- format(as.Date(all_trips$date), "%Y")
all_trips$day_of_week <- format(as.Date(all_trips$date), "%A")
```

#Add a ride_length calculation to all_trips (in seconds)
```{r}
all_trips$ride_length <- difftime(all_trips$ended_at, all_trips$started_at)
```

# Inspect the structure of the columns
```{r}
str(all_trips)
```

#Convert ride_length from Factor to numeric so we can run calculations on the data
```{r}
is.factor(all_trips$ride_length)
all_trips$ride_length <- as.numeric(as.character(all_trips$ride_length))
is.numeric(all_trips$ride_length)
```
#Remove bad data
```{r}
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" | all_trips$ride_length<0),]
```
#Step 4: Conduct Descriptive analysis
```{r}
mean(all_trips_v2$ride_length)
median(all_trips_v2$ride_length)
max(all_trips_v2$ride_length)
min(all_trips_v2$ride_length)

summary(all_trips_v2$ride_length)
```

#Compare members and casual users
```{r}
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = mean)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = median)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = max)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual, FUN = min)
```

#see the average ride time by each day for members vs casual users
```{r}
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week,
          FUN =  mean)
```
#Notice that the days of the weel are out of order. Let's fix that.
```{r}
all_trips_v2$day_of_week <- ordered(all_trips_v2$day_of_week, levels= c("Sunday", "Monday", "Tuesday",
                                                        "Wednesday", "Thursday", "Friday", "Saturday"))
```
#Now, Let's run the average ride time by each day for members vs casual users
```{r}
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual+all_trips_v2$day_of_week,FUN =  mean)
```
#analyze ridership data by type and weekday
```{r}
all_trips_v2 %>% 
  mutate(weekday=wday(started_at, label=TRUE)) %>% 
  group_by(member_casual, weekday) %>% 
  summarise(number_of_rides= n(), average_duration = mean(ride_length)) %>% 
  arrange(member_casual, weekday)
```

# visualize the number of rides by rider type
```{r}
all_trips_v2 %>% 
  mutate(weekday = wday(started_at,label=TRUE)) %>% 
  group_by(member_casual,weekday) %>% 
  summarise(number_of_rides = n(),
            average_duration =mean(ride_length)) %>% 
  arrange(member_casual,weekday) %>% 
  
ggplot(aes(x=weekday,y=number_of_rides, fill = member_casual)) +
    geom_col(position = "dodge")
```
# visulization for average duration
```{r}
all_trips_v2 %>% 
  mutate(weekday =wday(started_at,label = TRUE)) %>% 
  group_by(member_casual,weekday) %>% 
  summarise(number_of_rides = n(),
            average_duration = mean(ride_length)) %>% 
  arrange(member_casual,weekday) %>% 
  ggplot(aes(x= weekday,y=average_duration,fill = member_casual)) +
  geom_col(position = "dodge")
```
#Step 5: Export summary file for further analysis
```{r}
counts <- aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual+
                      all_trips_v2$day_of_week, FUN = mean)
                      write.csv(counts, file = 'avg_ride_length.csv')
```

## **5. Key Insights**

- Casual riders take longer trips but ride less frequently.
- Members ride more consistently across the year.
- Weekends show a spike in casual rider usage.
- Members dominate weekday commuting times.



## **6. Recommendations**

- Offer discounted weekend membership passes for casual riders.
- Push targeted ads for summer membership promotions.
- Create commuter-focused promotions (Monâ€“Fri ride benefits).
- Improve station density in high-casual-traffic areas.



## **7. Conclusion**

The analysis shows clear behavioral differences between rider groups, offering actionable strategies for converting casual riders to members.  
Further analysis can include station-level optimization and predictive modeling.


